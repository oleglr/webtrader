{"version":3,"sources":["../../../../src/navigation/menu.es6"],"names":["menu_config","trade","instruments","assetIndex","tradingTimes","trade_messages","no_symbol","i18n","extractFilteredMarkets","trading_times_data","options","markets","trading_times","map","m","market","name","display_name","submarkets","sm","submarket","symbols","filter","sym","symbol","delay_amount","events","times","settlement","feed_license","length","extractChartableMarkets","refreshMenu","root","callback","Object","values","menu","addClass","$","growl","error","message","removeClass","s","i","pip","join","$menu","find","remove","append","on","e","a","target","text","$li","closest","attr","detach","position","collision"],"mappings":"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","file":"menu.js","sourcesContent":["ï»¿import $ from 'jquery';\r\nimport '../common/util';\r\nimport \"jquery-growl\";\r\n\r\n/* you can filter the symbols with the options parameter, for example:\r\n   options: {\r\n       filter: (sym) => (sym.feed_license !== 'realtime')\r\n   }\r\n*/\r\nconst menu_config = {\r\n   trade : '.trade a',\r\n   instruments : '.instruments a',\r\n   assetIndex : '.assetIndex',\r\n   tradingTimes : '.tradingTimes',\r\n};\r\n\r\nconst trade_messages = {\r\n   no_symbol : () => \"Binary options trading is not available.\".i18n(),\r\n};\r\n\r\nexport const extractFilteredMarkets = (trading_times_data, options) => {\r\n   const markets = trading_times_data.trading_times.markets.map((m) => {\r\n      const market = {\r\n         name: m.name,\r\n         display_name: m.name\r\n      };\r\n      market.submarkets = m.submarkets.map((sm) => {\r\n         const submarket = {\r\n            name: sm.name,\r\n            display_name: sm.name\r\n         };\r\n         let symbols = sm.symbols;\r\n         if (options && options.filter) /* filter the symbols */\r\n            symbols = symbols.filter(options.filter);\r\n         submarket.instruments = symbols.map((sym) => {\r\n            return {\r\n               symbol: sym.symbol,\r\n               display_name: sym.name,\r\n               delay_amount: sym.delay_amount || 0,\r\n               events: sym.events,\r\n               times: sym.times,\r\n               settlement: sym.settlement,\r\n               feed_license: sym.feed_license || 'realtime'\r\n            };\r\n         });\r\n         return submarket;\r\n      })\r\n      /* there might be a submarket (e.g \"Americas\") which does not have any symbols after filtering */\r\n         .filter(\r\n            (sm) => (sm.instruments.length > 0)\r\n         );\r\n      return market;\r\n   });\r\n\r\n   return markets;\r\n};\r\n\r\nexport const extractChartableMarkets = (trading_times_data) => {\r\n   return extractFilteredMarkets(trading_times_data, {\r\n      filter: (sym) => (sym.feed_license !== 'chartonly')\r\n   }) || [];\r\n};\r\n\r\nexport const refreshMenu = (root, markets, callback) => {\r\n   \r\n   if(markets.length == 0){\r\n      Object.values(menu_config).map( menu => $(menu).addClass('disabled'));\r\n      $.growl.error({message: trade_messages.no_symbol()});\r\n   } else {\r\n      Object.values(menu_config).map( menu => $(menu).removeClass('disabled'));\r\n   }\r\n   const menu = `<ul>${\r\n      markets.map(m => `<li><div>${m.display_name}</div><ul>${\r\n         m.submarkets.map(s => `<li><div>${s.display_name}</div><ul>${\r\n            s.instruments.map(i => `<li symbol='${i.symbol}' pip='${i.pip}'><div>${i.display_name}</div></li>`).join('')\r\n         }</ul></li>`).join('')\r\n      }</ul></li>`).join('')\r\n   }</ul>`;\r\n   const $menu = $(menu);\r\n   root.find('> ul').menu('destroy').remove();\r\n   root.append($menu);\r\n   $menu.find('li[symbol]').on('click', (e,a) => {\r\n      const display_name = $(e.target).text();\r\n      const $li = $(e.target).closest('li');\r\n      const symbol = $li.attr('symbol');\r\n      const pip = $li.attr('pip');\r\n      $menu.detach();\r\n      root.append($menu);\r\n      callback(symbol, display_name, pip);\r\n   });\r\n   $menu.menu({ position: { collision: 'fit' } });\r\n}\r\n\r\nexport default {\r\n   extractChartableMarkets,\r\n   extractFilteredMarkets,\r\n   refreshMenu\r\n};\r\n"]}